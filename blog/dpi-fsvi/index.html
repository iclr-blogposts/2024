<!DOCTYPE html> <html> <script>let thunk=()=>{let e=e=>e.trim(),t=e=>e.innerText,n=e=>{let t=e.split(" "),n=t.slice(0,-1).join(" ");return[t.at(-1),n]},i=Array.from(document.getElementsByClassName("author")).map(t).map(e).map(n),a=i[0][0],o=(Array.from(document.getElementsByClassName("affiliation")).filter(e=>"P"===e.nodeName).map(t).map(e),"May 7, 2024"),r="Bridging the Data Processing Inequality and Function-Space Variational Inference",s="This blog post explores the interplay between the <i>Data Processing Inequality (DPI)</i>, a cornerstone concept in information theory, and <i>Function-Space Variational Inference (FSVI)</i> within the context of Bayesian deep learning. The DPI governs the transformation and flow of information through stochastic processes, and its unique connection to FSVI is employed to highlight FSVI's focus on Bayesian predictive posteriors over parameter space. The post examines various forms of the DPI, including the KL divergence based DPI, and provides intuitive examples and detailed proofs. It also explores the equality case of the DPI to gain a deeper understanding. The connection between DPI and FSVI is then established, showing how FSVI can measure a predictive divergence independent of parameter symmetries. The post relates FSVI to knowledge distillation and label entropy regularization, highlighting the practical relevance of the theoretical concepts. Throughout the post, theoretical concepts are intertwined with intuitive explanations and mathematical rigor, offering a comprehensive understanding of these complex topics. By examining these concepts in depth, the post provides valuable insights for both theory and practice in machine learning.";{let e=i.map(e=>`${e[0]}, ${e[1]}`).join(" and "),t=`\n@inproceedings{${(a+"2024"+r.split(" ").slice(0,3).join("")).replace(" ","").replace(/[\p{P}$+<=>^`|~]/gu,"").toLowerCase().trim()},\n  author = {${e}},\n  title = {${r}},\n  abstract = {${s}},\n  booktitle = {ICLR Blogposts 2024},\n  year = {2024},\n  date = {${o}},\n  note = {${window.location.href}},\n  url  = {${window.location.href}}\n}\n  `.trim();document.getElementById("bibtex-box").innerText=t}{let e=i.map(e=>e[0]),t=`\n${e=e.length>2?e[0]+", et al.":2==e.length?e[0]+" & "+e[1]:e[0]}, "${r}", ICLR Blogposts, 2024.\n`.trim();document.getElementById("bibtex-academic-attribution").innerText=t}};document.addEventListener("readystatechange",function(){"complete"===document.readyState&&thunk()});</script> <head> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Bridging the Data Processing Inequality and Function-Space Variational Inference | ICLR Blogposts 2024</title> <meta name="author" content="ICLR Blog"/> <meta name="description" content="This blog post explores the interplay between the <i>Data Processing Inequality (DPI)</i>, a cornerstone concept in information theory, and <i>Function-Space Variational Inference (FSVI)</i> within the context of Bayesian deep learning. The DPI governs the transformation and flow of information through stochastic processes, and its unique connection to FSVI is employed to highlight FSVI's focus on Bayesian predictive posteriors over parameter space. The post examines various forms of the DPI, including the KL divergence based DPI, and provides intuitive examples and detailed proofs. It also explores the equality case of the DPI to gain a deeper understanding. The connection between DPI and FSVI is then established, showing how FSVI can measure a predictive divergence independent of parameter symmetries. The post relates FSVI to knowledge distillation and label entropy regularization, highlighting the practical relevance of the theoretical concepts. Throughout the post, theoretical concepts are intertwined with intuitive explanations and mathematical rigor, offering a comprehensive understanding of these complex topics. By examining these concepts in depth, the post provides valuable insights for both theory and practice in machine learning." /> <meta name="keywords" content="machine-learning, ml, deep-learning, reinforcement-learning, iclr"/> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"/> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"/> <link rel="shortcut icon" href="/2024/assets/img/iclr_favicon.ico"/> <link rel="stylesheet" href="/2024/assets/css/main.css"> <link rel="canonical" href="https://iclr-blogposts.github.io/2024/blog/dpi-fsvi/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"/> <script src="/2024/assets/js/theme.js"></script> <script src="/2024/assets/js/dark_mode.js"></script> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src="/2024/assets/js/distillpub/template.v2.js"></script> <script src="/2024/assets/js/distillpub/transforms.v2.js"></script> <script src="/2024/assets/js/distillpub/overrides.js"></script> <style type="text/css">.fake-img{background:#bbb;border:1px solid rgba(0,0,0,0.1);box-shadow:0 0 4px rgba(0,0,0,0.1);margin-bottom:12px}.fake-img p{font-family:monospace;color:white;text-align:left;margin:12px 0;text-align:center;font-size:16px}.box-note,.box-warning,.box-error,.box-important{padding:15px 15px 15px 10px;margin:20px 20px 20px 5px;border:1px solid #eee;border-left-width:5px;border-radius:5px 3px 3px 5px}d-article .box-note{background-color:#eee;border-left-color:#2980b9}d-article .box-warning{background-color:#fdf5d4;border-left-color:#f1c40f}d-article .box-error{background-color:#f4dddb;border-left-color:#c0392b}d-article .box-important{background-color:#d4f4dd;border-left-color:#2bc039}html[data-theme='dark'] d-article .box-note{background-color:#333;border-left-color:#2980b9}html[data-theme='dark'] d-article .box-warning{background-color:#3f3f00;border-left-color:#f1c40f}html[data-theme='dark'] d-article .box-error{background-color:#300000;border-left-color:#c0392b}html[data-theme='dark'] d-article .box-important{background-color:#030;border-left-color:#2bc039}html[data-theme='dark'] d-article blockquote{color:var(--global-text-color)!important}html[data-theme='dark'] d-article summary{color:var(--global-text-color)!important}d-article aside *{color:var(--global-text-color)!important}d-article p{text-align:justify;text-justify:inter-word;-ms-hyphens:auto;-moz-hyphens:auto;-webkit-hyphens:auto;hyphens:auto}d-article aside{border:1px solid #aaa;border-radius:4px;padding:.5em .5em 0;font-size:90%}d-article aside p:first-child{margin-top:0}d-article details{border:1px solid #aaa;border-radius:4px;padding:.5em .5em 0}d-article summary{font-weight:bold;margin:-.5em -.5em 0;padding:.5em;display:list-item}d-article details[open]{padding:.5em}d-article details[open] summary{border-bottom:1px solid #aaa;margin-bottom:.5em}</style> </head> <d-front-matter> <script async type="text/json">{
      "title": "Bridging the Data Processing Inequality and Function-Space Variational Inference",
      "description": "This blog post explores the interplay between the <i>Data Processing Inequality (DPI)</i>, a cornerstone concept in information theory, and <i>Function-Space Variational Inference (FSVI)</i> within the context of Bayesian deep learning. The DPI governs the transformation and flow of information through stochastic processes, and its unique connection to FSVI is employed to highlight FSVI's focus on Bayesian predictive posteriors over parameter space. The post examines various forms of the DPI, including the KL divergence based DPI, and provides intuitive examples and detailed proofs. It also explores the equality case of the DPI to gain a deeper understanding. The connection between DPI and FSVI is then established, showing how FSVI can measure a predictive divergence independent of parameter symmetries. The post relates FSVI to knowledge distillation and label entropy regularization, highlighting the practical relevance of the theoretical concepts. Throughout the post, theoretical concepts are intertwined with intuitive explanations and mathematical rigor, offering a comprehensive understanding of these complex topics. By examining these concepts in depth, the post provides valuable insights for both theory and practice in machine learning.",
      "published": "May 7, 2024",
      "authors": [
        {
          "author": "Andreas Kirsch",
          "authorURL": "https://www.blackhc.net",
          "affiliations": [
            {
              "name": "University of Oxford<sup>&ndash;2023</sup>",
              "url": ""
            }
          ]
        }
        
      ],
      "katex": {
        "delimiters": [
          {
            "left": "$",
            "right": "$",
            "display": false
          },
          {
            "left": "$$",
            "right": "$$",
            "display": true
          }
        ]
      }
    }</script> </d-front-matter> <body class="fixed-top-nav"> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/2024/">ICLR Blogposts 2024</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/2024/about/">about</a> </li> <li class="nav-item "> <a class="nav-link" href="/2024/call/">call for blogposts</a> </li> <li class="nav-item "> <a class="nav-link" href="/2024/submitting/">submitting</a> </li> <li class="nav-item "> <a class="nav-link" href="/2024/reviewing/">reviewing</a> </li> <li class="nav-item "> <a class="nav-link" href="/2024/blog/index.html">blog</a> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">other iterations</a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item" href="https://iclr-blogposts.github.io/2025/">2025</a> <div class="dropdown-divider"></div> <a class="dropdown-item" href="https://iclr-blogposts.github.io/2024/"><strong>2024</strong></a> <div class="dropdown-divider"></div> <a class="dropdown-item" href="https://iclr-blogposts.github.io/2023/">2023</a> <div class="dropdown-divider"></div> <a class="dropdown-item" href="https://iclr-blog-track.github.io/home/" target="_blank" rel="noopener noreferrer">2022</a> </div> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> </header> <div class="post distill"> <d-title> <h1>Bridging the Data Processing Inequality and Function-Space Variational Inference</h1> <p>This blog post explores the interplay between the <i>Data Processing Inequality (DPI)</i>, a cornerstone concept in information theory, and <i>Function-Space Variational Inference (FSVI)</i> within the context of Bayesian deep learning. The DPI governs the transformation and flow of information through stochastic processes, and its unique connection to FSVI is employed to highlight FSVI's focus on Bayesian predictive posteriors over parameter space. The post examines various forms of the DPI, including the KL divergence based DPI, and provides intuitive examples and detailed proofs. It also explores the equality case of the DPI to gain a deeper understanding. The connection between DPI and FSVI is then established, showing how FSVI can measure a predictive divergence independent of parameter symmetries. The post relates FSVI to knowledge distillation and label entropy regularization, highlighting the practical relevance of the theoretical concepts. Throughout the post, theoretical concepts are intertwined with intuitive explanations and mathematical rigor, offering a comprehensive understanding of these complex topics. By examining these concepts in depth, the post provides valuable insights for both theory and practice in machine learning.</p> </d-title> <d-byline></d-byline> <d-article> <d-contents> <nav class="l-text figcaption"> <h3>Contents</h3> <div><a href="#introduction">Introduction</a></div> <div><a href="#background-information-theoretic-notation">Background: Information-Theoretic Notation</a></div> <div><a href="#data-processing-inequality">Data Processing Inequality</a></div> <ul> <li><a href="#example-image-processing-pipeline">Example: Image Processing Pipeline</a></li> <li><a href="#example-supervised-learning">Example: Supervised Learning</a></li> <li><a href="#example-autoencoders">Example: Autoencoders</a></li> <li><a href="#proof-of-the-dpi">Proof of the DPI</a></li> </ul> <div><a href="#data-processing-inequality">🥬 Data Processing Inequality</a></div> <ul> <li><a href="#example-comparing-image-distributions">Example: Comparing Image Distributions</a></li> <li><a href="#counter-example-bayesian-inference">Counter-Example: Bayesian Inference</a></li> <li><a href="#proofs-of-the-dpi">Proofs of the 🥬 DPI</a></li> <li><a href="#overall-statement">Overall Statement</a></li> </ul> <div><a href="#other-data-processing-inequalities">Other Data Processing Inequalities</a></div> <ul> <li><a href="#jensen-shannon-divergence">Jensen-Shannon Divergence</a></li> <li><a href="#jsd-dpi">JSD-DPI</a></li> <li><a href="#mutual-information">Mutual Information</a></li> </ul> <div><a href="#function-space-variational-inference">Function-Space Variational Inference</a></div> <ul> <li><a href="#problem-setting-notation">Problem Setting &amp; Notation</a></li> <li><a href="#chain-rule-of-the-divergence-dpi">Chain Rule of the 🥬 Divergence &amp; DPI</a></li> <li><a href="#deriving-the-functional-elbo">Deriving the Functional ELBO</a></li> <li><a href="#choosing-the-coreset">Choosing the "Coreset"</a></li> <li><a href="#application-to-continual-learning">Application to Continual Learning</a></li> </ul> <div><a href="#comparison-to-fsvi-in-the-literature">Comparison to FSVI in the Literature</a></div> <div><a href="#the-equality-case-and-equivalence-classes">The Equality Case and Equivalence Classes</a></div> <ul> <li><a href="#equivalence-classes">Equivalence Classes</a></li> <li><a href="#consistency">Consistency</a></li> <li><a href="#equality-symmetries">Equality &amp; Symmetries</a></li> <li><a href="#predictive-prior">Predictive Prior</a></li> <li><a href="#the-fsvi-objective">The FSVI Objective</a></li> </ul> <div><a href="#parameter-priors-vs-predictive-priors">Parameter Priors vs. Predictive Priors</a></div> <ul> <li><a href="#label-entropy-regularization">Label Entropy Regularization</a></li> <li><a href="#knowledge-distillation">Knowledge Distillation</a></li> </ul> <div><a href="#conclusion">Conclusion</a></div> </nav> </d-contents> <div style="display: none;"> $$\require{mathtools} \DeclareMathOperator{\opExpectation}{\mathbb{E}} \newcommand{\E}[2]{\opExpectation_{#1} \left [ #2 \right ]} \newcommand{\simpleE}[1]{\opExpectation_{#1}} \newcommand{\MidSymbol}[1][]{\:#1\:} \newcommand{\given}{\MidSymbol[\vert]} \DeclareMathOperator{\opmus}{\mu^*} \newcommand{\IMof}[1]{\opmus[#1]} \DeclareMathOperator{\opInformationContent}{H} \newcommand{\ICof}[1]{\opInformationContent[#1]} \newcommand{\xICof}[1]{\opInformationContent(#1)} \DeclareMathOperator{\opEntropy}{H} \newcommand{\Hof}[1]{\opEntropy[#1]} \newcommand{\xHof}[1]{\opEntropy(#1)} \DeclareMathOperator{\opMI}{I} \newcommand{\MIof}[1]{\opMI[#1]} \DeclareMathOperator{\opTC}{TC} \newcommand{\TCof}[1]{\opTC[#1]} \newcommand{\CrossEntropy}[2]{\opEntropy(#1 \MidSymbol[\Vert] #2)} \DeclareMathOperator{\opKale}{D_\mathrm{KL}} \newcommand{\Kale}[2]{\opKale(#1 \MidSymbol[\Vert] #2)} \DeclareMathOperator{\opJSD}{D_\mathrm{JSD}} \newcommand{\JSD}[2]{\opJSD(#1 \MidSymbol[\Vert] #2)} \DeclareMathOperator{\opp}{p} \newcommand{\pof}[1]{\opp(#1)} \newcommand{\hpof}[1]{\hat{\opp}(#1)} \newcommand{\pcof}[2]{\opp_{#1}(#2)} \newcommand{\hpcof}[2]{\hat\opp_{#1}(#2)} \DeclareMathOperator{\opq}{q} \newcommand{\qof}[1]{\opq(#1)} \newcommand{\hqof}[1]{\hat{\opq}(#1)} \newcommand{\qcof}[2]{\opq_{#1}(#2)} \newcommand{\varHof}[2]{\opEntropy_{#1}[#2]} \newcommand{\xvarHof}[2]{\opEntropy_{#1}(#2)} \newcommand{\varMIof}[2]{\opMI_{#1}[#2]} \newcommand{\w}{\boldsymbol{\theta}} \newcommand{\W}{\boldsymbol{\Theta}} \DeclareMathOperator{\opf}{f} \newcommand{\fof}[1]{\opf(#1)} \newcommand{\Dany}{\mathcal{D}} \newcommand{\y}{y} \newcommand{\Y}{Y} \newcommand{\L}{\boldsymbol{L}} \newcommand{\x}{\boldsymbol{x}} \newcommand{\X}{\boldsymbol{X}} \newcommand{\pdata}[1]{\hpcof{\text{data}}{#1}} \newcommand{\normaldist}[1]{\mathcal{N}(#1)} $$ </div> <h2 id="introduction">Introduction</h2> <p>In information theory, the <strong>data processing inequality (DPI)</strong> expresses a fundamental idea: processing data (stochastically) cannot increase information. The DPI provides us with a powerful intuition about what information processing systems can do and what the limitations of data processing are.</p> <p>In this blog post, we first study the DPI, developing intuition through vivid examples and detailed proofs—especially the equality case, which is arguably the best way to understand inequalities. We will consider classic forms of the DPI as well as DPIs relating probability distributions more broadly. Then, we explore the intriguing connection between DPI and <strong>function-space variational inference (FSVI)</strong>, a modern Bayesian deep learning technique that focuses on the Bayesian predictive posterior rather than the parameter space. Exploring this connection is important because it can provide new insights into FSVI on a fundamental level. We apply the DPI to recover several interesting results from the literature in a simple form and build intuitions for the relationship between parameter and functional priors.</p> <p>Most importantly, we consider how FSVI can measure a <em>predictive</em> divergence between the approximate and true posterior which is independent of parameter symmetries. (With parameter symmetries, I refer to different parameters that yield the same predictions, which is very common in over-parameterized neural networks: think of parameter symmetries like different paths leading to the same destination; they might look different but end up at the same predictions<d-footnote>Thanks to ChatGPT for this analogy! 🤗</d-footnote>.) Explaining this connection is one of the main goals of this article and will help you understand the relationships between DPI, FSVI, and other deep learning methods. As a concrete example and application, we relate FSVI to training with knowledge distillation and label entropy regularization: potentially more meaningful priors than the ones usually used in Bayesian neural networks<d-footnote>In many papers, an isotropic Gaussian is used because of its simplicity. Indeed, there are better alternatives, see Fortuin et al (2022)<d-cite key="fortuin2022bayesian"></d-cite> and Fortuin (2022)<d-cite key="fortuin2022priors"></d-cite>.</d-footnote>. This connection highlights the practical relevance of the theoretical concepts discussed in this post and will hopefully inspire the reader to view Bayesian deep learning from a new point of view.</p> <h3 id="tldr">TL;DR</h3> <p>The following sections summarize the key takeaways of this blog post. If they don’t make sense, don’t worry: they will after reading this post.</p> <h4 id="data-processing-inequality">Data Processing Inequality</h4> <p>The data processing inequality examines how information cannot increase due to processing. In information theory, it is usually stated based on a Markov chain of random variables \(X \rightarrow Y \rightarrow Z\) and their mutual information. We will look at different data processing inequalities that relate different distributions instead of different random variables. However, the blog posts in particular looks at the DPI when formulated using Kullback-Leibler (KL) divergences between distributions. I will use “🥬 divergence” in headings to add a bit of color. 😊</p> <p>Concretely, this KL DPI states that processing data stochastically can only reduce information. More formally:</p> <aside class="l-body box-important"> <p>Consider two distributions \(\qof{\W}\) and \(\pof{\W}\) over a random variable \(\W\). Let \(Y = \fof{\W}\) be a stochastic mapping from \(\W\) to \(Y\)—that is, we could imagine having a noise random variable \(\boldsymbol{Z}\) as a hidden input to \(\fof{\W}\), i.e. \(\fof{\W;\boldsymbol{Z}}\). Then the DPI states:</p> \[\Kale{\qof{\W}}{\pof{\W}} \ge \Kale{\qof{Y}}{\pof{Y}}.\] </aside> <p>That is, the KL divergence between \(\qof{Y}\) and \(\pof{Y}\) cannot be larger than the one between the original \(\qof{\W}\) and \(\pof{\W}\). Intuitively, the stochastic mapping \(\opf\) induces a bottleneck that reduces how well we can distinguish between \(\opp\) and \(\opq\). Finally we have equality when \(\Kale{\qof{\W \given Y}}{\pof{\W \given Y}} = 0\).</p> <p>The paper “<em>Understanding Variational Inference in Function-Space</em>” by Burt et al. (2021)<d-cite key="burt2021understanding"></d-cite> succinctly summarizes the DPI as follows:</p> <blockquote> The data processing inequality states that if two random variables are transformed in this way, they cannot become easier to tell apart. </blockquote> <h4 id="function-space-variational-inference">Function-Space Variational Inference</h4> <p>Generally, <em>variational inference</em> is a powerful technique for approximating complex Bayesian posteriors with simpler distributions. In its usual form, it optimizes an approximate, <em>variational</em> distribution to match the <em>Bayesian <strong>parameter</strong> posterior</em> as closely as possible. This way, it transforms the problem of Bayesian inference into an optimization problem.</p> <p>However, especially for deep neural networks, obtaining a good approximation of the parameter space can be difficult. One reason is the sheer size of the parameter space. Additionally, the parameterization of a neural network often contains many symmetries—different parameter configurations can lead to the same predictions of the model—that are not taken into account either.</p> <p>Here, <strong>Function-space variational inference (FSVI)</strong> side-steps some of these restrictions by only requiring that the variational distribution matches the <em>Bayesian <strong>predictive</strong> posterior</em>:</p> <p>If we define equivalence classes of model parameters according to the model predictions, FSVI aims to approximate the posterior distribution over <em>equivalence classes</em> of parameters \(\pof{[\w] \given \Dany}\) rather than the posterior over raw parameters \(\pof{\w \given \Dany}\). This is because \(\pof{[\w] \given \Dany}\) captures the meaningful aspects of the posterior, as it is invariant to the symmetries and equivalences in the parameter space that leave the likelihood unchanged.</p> <p>To achieve this, FSVI employs an implicit variational distribution \(\qof{[\w]}\) and minimizes an objective that is equivalent to regular variational inference on the equivalence classes \(\Kale{\qof{[\W]}}{\pof{[\W] \given \Dany}}\).</p> <p>By using an implicit variational distribution and leveraging the DPI, FSVI sidesteps the need to explicitly define the equivalence classes or specify a model that operates on them directly. Instead, FSVI relies on the fact that matching the predictive prior distributions in the limit of infinite data is sufficient to match the posteriors over equivalence classes overall. This leads to approximations we can connect to label entropy regularization and knowledge distillation.</p> <aside class="l-body box-important"> <p>Function-space variational inference (FSVI) is a principled approach to Bayesian inference that respects the inherent symmetries and equivalences in overparameterized models. It focuses on approximating the meaningful posterior \(\pof{[\w] \given \Dany}\) while avoiding the complexities of explicitly constructing and working with equivalence classes. The FSVI-ELBO regularizes towards a data prior:</p> \[\begin{aligned} \E{\qof{\w}}{-\log \pof{\Dany \given \w}} + \Kale{\qof{\Y... \given \x...}}{\pof{\Y... \given \x...}}, \end{aligned}\] <p>unlike in regular variational inference, where we regularize towards a parameter prior \(\Kale{\qof{\W}}{\pof{\W}}\).</p> </aside> <h2 id="background-information-theoretic-notation">Background: Information-Theoretic Notation</h2> <p>Information theory deals with the communication of information<d-footnote>See the excellent <a href="https://colah.github.io/posts/2015-09-Visual-Information/" target="_blank" rel="noopener noreferrer">"Visual Information Theory"</a> by Chris Olah for a visual introduction to information theory.</d-footnote>. In this blog post, we use a unified information-theoretic notation to express various quantities related to probability distributions and their relationships<d-footnote>It largely follows "<a href="https://arxiv.org/abs/2106.12062" target="_blank" rel="noopener noreferrer">A Practical &amp; Unified Notation for Information-Theoretic Quantities in ML</a>".</d-footnote>. Here are some key concepts we will use:</p> <p>The <strong>information content</strong> of an event \(x\) is denoted as \(\Hof{x}\) and is defined as \(-\log \pof{x}\). It represents the minimum amount of information needed to describe the occurrence of \(x\) given an underlying probability distribution. In machine learning, this information content is often used as a minimization objective, represented as the negative log-likelihood or cross-entropy when averaged over a dataset.</p> <p>The <strong>entropy</strong> \(\Hof{X}\) of a random variable \(X\) is the expectation of its information content:</p> \[\Hof{X} \triangleq \E{\pof{x}}{\Hof{x}} = \E{\pof{x}}{-\log \pof{x}}.\] <p>The entropy measures the average amount of information needed to describe the random variable \(X\). It provides a measure of uncertainty or randomness associated with \(X\). We can similarly define the entropy of a conditional distribution \(\Hof{X \given Y}\) and the joint entropy \(\Hof{X, Y}\).</p> <p>The <strong>mutual information</strong> \(\MIof{X;Y}\) between two random variables \(X\) and \(Y\) is a measure of the amount of information that one random variable contains about the other. It is defined as:</p> \[\begin{aligned} \MIof{X;Y} &amp; \triangleq \Hof{X} - \Hof{X \given Y} \\ &amp;= \Hof{Y} - \Hof{Y \given X} \\ &amp;= \Hof{X} + \Hof{Y} - \Hof{X, Y}. \end{aligned}\] <p>We will also use the <strong>Kullback-Leibler divergence</strong> \(\Kale{\pof{X}}{\qof{X}}\) and the <strong>cross-entropy</strong> \(\CrossEntropy{\pof{X}}{\qof{X}}\):</p> \[\begin{aligned} \CrossEntropy{\pof{X}}{\qof{X}} &amp; = \E{\pof{x}}{-\log \qof{x}}\\ \Kale{\pof{X}}{\qof{X}} &amp; = \CrossEntropy{\pof{X}}{\qof{X}} - \Hof{X} \end{aligned}\] <p>The cross-entropy quantifies the average number of bits needed to encode samples drawn from the true distribution \(\pof{X}\) using a different distribution \(\qof{X}\). The Kullback-Leibler divergence is a measure of the difference between two probability distributions and captures the additional bits needed to encode samples from \(\pof{X}\) compared to encoding them using the true distribution \(\qof{X}\).</p> <p>Now that we have covered the notation, let’s delve into the data processing inequality.</p> <h2 id="data-processing-inequality-1">Data Processing Inequality</h2> <p>The <strong>data processing inequality (DPI)</strong> is a fundamental inequality in information theory that states the mutual information between two random variables cannot increase through processing. The original DPI is typically stated for a Markov chain of random variables \(X \rightarrow Y \rightarrow Z\) and relates the mutual information terms as follows:</p> \[\MIof{X;Y} \ge \MIof{X;Z}.\] <p>We can view \(\rightarrow\) as a processing or transition step that maps \(X\) to \(Y\) and \(Y\) to \(Z\), whereas the mapping can be deterministic or stochastic. The inequality tells us that processing the random variable \(X\) to obtain \(Y\) and further processing \(Y\) to obtain \(Z\) cannot increase the mutual information between \(X\) and \(Z\) compared to the mutual information between \(X\) and \(Y\).</p> <p>The following three scenarios illustrate the data processing inequality using different mappings:</p> <h3 id="example-image-processing-pipeline">Example: Image Processing Pipeline</h3> <p>Consider an image processing pipeline with the following steps. Let:</p> <ul> <li>\(X\) be the original image data;</li> <li>\(Y\) be a compressed version of the image; and</li> <li>\(Z\) be \(Y\) after adding blur and pixelation.</li> </ul> <p>In this case, \(X\) has more mutual information with \(Y\) than with \(Z\). The compression reduces information, but the image is still recognizable. However, after the additional processing of blurring and pixelating, the mutual information between \(X\) and \(Z\) is further reduced. This gives an intuitive example of how additional processing on data reduces the mutual information with the original data. Each processing step results in some loss of information.</p> <h3 id="example-supervised-learning">Example: Supervised Learning</h3> <p>Consider a supervised learning pipeline with the following steps. Let</p> <ul> <li>\(X\) be the input features;</li> <li>\(Y\) be the intermediate representations learned by the model; and</li> <li>\(Z\) be the model predictions.</li> </ul> <p>Here, \(X \rightarrow Y \rightarrow Z\) forms a Markov chain. The data processing inequality tells us that the mutual information between the inputs \(X\) and predictions \(Z\) cannot exceed the mutual information between the inputs \(X\) and intermediate representations \(Y\):</p> \[\MIof{X; Y} \geq \MIof{X; Z}.\] <p>This makes intuitive sense—the intermediate representations \(Y\) are obtained by processing the raw inputs \(X\), so they cannot contain more information about \(X\) than \(X\) itself. The predictions \(Z\) are obtained by further processing \(Y\), so additional information may be lost, reducing the mutual information with the original inputs \(X\).</p> <p>As a more concrete example, consider an image classification model. Let:</p> <ul> <li>\(X\) be the input images;</li> <li>\(Y\) be the activations of the convolutional layers; and</li> <li>\(Z\) be predicted image labels.</li> </ul> <p>The convolutional layers will extract features from the input images, but cannot extract more information than present in the original images. The predicted labels are obtained by further processing these convolutional features, so may lose some fine-grained information about the original inputs.</p> <h3 id="example-autoencoders">Example: Autoencoders</h3> <p>An autoencoder compresses the input \(X\) into a latent code \(Y\) and then tries to reconstruct the original input from the code, producing \(\hat{X}\). Let:</p> <ul> <li>\(X\) be the input;</li> <li>\(Y\) be the latent code; and</li> <li>\(\hat{X}\) be the reconstruction;</li> </ul> <p>The data processing inequality tells us again:</p> \[\MIof{X; Y} \geq \MIof{X; \hat{X}}.\] <p>The latent code \(Y\) is obtained by compressing \(X\), so cannot contain more information. The reconstruction \(\hat{X}\) tries to recover \(X\) from \(Y\), but some information may be lost, reducing the mutual information with \(X\).</p> <p>Intuitively, autoencoders try to preserve as much mutual information between inputs \(X\) and reconstructions \(\hat{X}\) as possible by learning latent representations \(Y\) that compress inputs without losing too much information. The data processing inequality quantifies this information bottleneck.</p> <h3 id="proof-of-the-dpi">Proof of the DPI</h3> <p>The proof is simple and connects the DPI to another important inequality.</p> <p>First we note that the Markov Chain implies the following factorization of the joint distribution:</p> \[\pof{x, y, z} = \pof{x} \pof{y \given x} \pof{z \given y}.\] <p>Using this factorization, we can express the mutual information terms:</p> \[\begin{aligned} \MIof{X;Y} &amp;= \Hof{X} - \Hof{X \given Y} \\ &amp;\ge \Hof{X} - \Hof{X \given Z} \\ &amp;= \MIof{X;Z}. \end{aligned}\] <p>This relies on \(\Hof{X \given Y} \le \Hof{X \given Z}\). Why is this true?</p> <p>We have the following chain of inequalities:</p> \[\Hof{X \given Y} = \underbrace{\MIof{X ; Z \given Y}}_{\overset{(1)}{=}0} + \Hof{X \given Y, Z} \overset{(2)}{\le} \Hof{X \given Z}.\] <p><strong>(1)</strong> follows from the Markov chain property: when \(X \rightarrow Y \rightarrow Z\), \(X\) does not depend on \(Z\) at all when conditioned on \(Y\); and <strong>(2)</strong> follows from the fact that conditioning reduces entropy, i.e. \(\Hof{A \given B} \le \Hof{A}.\)</p> <p>The equality gap \(\Hof{X \given Y, Z} - \Hof{X \given Z}\) corresponds to the mutual information \(\MIof{X ; Y \given Z}\). This mutual information measures the extra information about \(X\) contained in \(Y\) that is not already conveyed by \(Z\). It is zero if and only if \(X \rightarrow Z \rightarrow Y\) forms a Markov chain, indicating that \(Z\) is a sufficient statistic for \(X\).</p> <details> <summary>Proof of <i>(2)</i> "Conditioning Reduces Entropy":</summary> <p>We can easily show that conditioning reduces entropy by using the non-negative property of the mutual information:</p> <p>\(\begin{aligned} 0 &amp;\le \Kale{\pof{X,Y}}{\pof{X}\pof{Y}} \\ &amp;= \MIof{X;Y} \\ &amp;= \Hof{X} - \Hof{X \given Y} \\ \implies \Hof{X \given Y} &amp;\le \Hof{X}. \end{aligned}\)</p> </details> <p>The fact that conditioning reduces entropy, \(\Hof{X} \ge \Hof{X \given Y}\), is an important property by itself and is reminiscent of the data processing inequality. The conditional entropy \(\Hof{X \given Y}\) quantifies the remaining uncertainty about \(X\) after observing \(Y\). If \(X\) and \(Y\) are independent, then \(\Hof{X} = \Hof{X \given Y}\), as knowing \(Y\) does not provide any information about \(X\). On the other hand, if \(Y\) completely determines \(X\), then \(\Hof{X \given Y} = 0\), as there is no remaining uncertainty about \(X\) once \(Y\) is known. In general, conditioning can only reduce the uncertainty about \(X\), but it does not necessarily reduce it to zero.</p> <p>Let’s move on and consider the KL data processing inequality.</p> <h2 id="-data-processing-inequality">🥬 Data Processing Inequality</h2> <p>A similar DPI can be expressed for different distributions \(\pof{x}\) and \(\qof{x}\) of the same random variable and the KL divergence between them. This DPI states that if we evolve two distributions using the same <em>transition function</em>, they cannot become less similar. The KL divergence is sometimes also referred to as “relative entropy”, so we could also call this the “<em>relative data processing inequality</em>”.</p> <p>This can be formalized for distributions \(\pof{x}\) and \(\qof{x}\) and a stochastic transition function \(X \overset{\fof{y \given x}}{\longrightarrow} Y\). Here, we use that such a stochastic mapping \(Y = \fof{X}\) is equivalent to having a probability (density) \(\fof{y \given x}\):</p> \[\Kale{\pof{X}}{\qof{X}} \ge \Kale{\pof{Y}}{\qof{Y}},\] <p>where \(\pof{y \given x} = \fof{y \given x} = \qof{y \given x}\). The marginals after the transition are \(\pof{y} = \E{\pof{x}}{\fof{y \given x}}\) and \(\qof{y} = \E{\qof{x}}{\fof{y \given x}}\), so more explicitly:</p> \[\Kale{\pof{X}}{\qof{X}} \ge \Kale{\E{\pof{x}}{\fof{Y \given x}}}{\E{\qof{x}}{\fof{Y \given x}}}.\] <p>In their book <a href="https://www.wiley.com/en-us/Elements+of+Information+Theory%2C+2nd+Edition-p-9780471241959" target="_blank" rel="noopener noreferrer">Elements of Information Theory</a>, Thomas and Cover describe this as “relative entropy never increases” and relate it to the second law of thermodynamics.</p> <h3 id="example-comparing-image-distributions">Example: Comparing Image Distributions</h3> <p>As an example, let:</p> <ul> <li>\(\pof{x}\) be the true distribution of images in a dataset;</li> <li>\(\qof{x}\) be a generative model that tries to mimic \(\pof{x}\); and</li> <li>\(\fof{y \given x}\) be a function that thresholds images \(x\) into bilevel black and white images \(y\).</li> </ul> <p>Then \(\pof{y}\) and \(\qof{y}\) will be more difficult to distinguish after the thresholding operation than \(\pof{x}\) and \(\qof{x}\). Converting to black and white images has lost information that could help distinguish the real and generated distributions.</p> <p>This provides some intuition for why the KL divergence between distributions decreases under a shared stochastic mapping, as formalized by the KL data processing inequality. Processing through \(\fof{y \given x}\) makes the distributions harder to tell apart.</p> <h3 id="counter-example-bayesian-inference">Counter-Example: Bayesian Inference</h3> <p>It might be inviting to think that this data processing inequality also applies to Bayesian inference, that is updating the model parameters based on new evidence. Then, we could argue that if two agents start with different prior beliefs but update based on the same evidence, their posterior beliefs will become more similar. However, this intuition is flawed: the data processing inequality does not apply to Bayesian inference.</p> <p>Let’s walk through why. Consider:</p> <ul> <li>\(\pof{\w}\) be an agent’s prior belief;</li> <li>\(\qof{\w}\) be another agent’s different prior;</li> <li>\(\pof{\w\given x}\) is the posterior after observing data \(x\); and</li> <li>\(\qof{\w\given x}\) is the other agent’s posterior.</li> </ul> <p>The priors \(\pof{\w}\) and \(\qof{\w}\) may have large divergence, representing very different initial beliefs. However, when conditioning on the same data \(x\), the KL divergence between \(\pof{\w \given x}\) and \(\qof{\w \given x}\) could increase or decrease—the data processing inequality does not give us any guarantee.</p> <p>This is because \(\pof{\w}\) and \(\qof{\w}\) are not evolving under the same stochastic mapping. Rather, each prior is mapped to its respective posterior via Bayes’ rule, which operates differently on \(\opp\) and \(\opq\):</p> \[\begin{aligned} \pof{\w \given x} &amp;= \frac{\pof{x \given \w}}{\pof{x}} \, \pof{\w}\\ \qof{\w \given x} &amp;= \frac{\qof{x \given \w}}{\qof{x}} \, \qof{\w}. \end{aligned}\] <p>Even assuming that both agents have the same internal model, that is they use the same likelihood \(\pof{x \given \w} = \qof{x \given \w}\), the priors \(\pof{\w}\) and \(\qof{\w}\) will still influence the posterior distributions differently because they lead to different evidence terms \(\pof{x}\) and \(\qof{x}\):</p> \[\begin{aligned} \pof{x} &amp;= \E{\pof{\w}}{\pof{x \given \w}}\\ \qof{x} &amp;= \E{\qof{\w}}{\qof{x \given \w}}. \end{aligned}\] <p>Thus, the correct intuition is that observing the same data \(x\) does not necessarily bring the posterior beliefs closer together—they depend on the interplay between their specific priors and likelihoods. The data processing inequality does not directly apply to this Bayesian updating scenario:</p> \[\Kale{\qof{\W}}{\pof{\W}} {\color{red}{\not\ge}} \Kale{\qof{\W \given \mathcal{D}}}{\pof{\W \given \mathcal{D}}},\] <p>This counterexample highlights the importance of precisely understanding the assumptions underlying conceptual principles like the DPI. While the DPI provides insight about information dynamics in many cases, it does not universally apply, as exemplified here by Bayesian updating under different priors. As always, bear in mind that:</p> <aside class="l-body box-note"> <p>Identifying counterexamples sharpens our comprehension of the true meaning and limitations of information-theoretic inequalities.</p> </aside> <p>As we currently also seem to experience a world of increasing polarization, this counterexample might also serve as a reminder that different priors can lead to different beliefs, even when observing the same evidence. This is a fundamental aspect of Bayesian inference and the scientific method.</p> <h3 id="proofs-of-the--dpi">Proofs of the 🥬 DPI</h3> <p>We will prove this inequality in two different ways. First, we will develop a “brute-force” proof, and then we will look at a more elegant proof that follows Thomas and Cover. Importantly, we will also consider the equality case in detail.</p> <h4 id="brute-force-proof">Brute-force Proof</h4> <p>If \(\opp\) does not have support in \(\opq\), the inequality is trivially true because then \(\Kale{\pof{Y}}{\qof{Y}}=\infty\).</p> <p>Thus, let’s now assume that \(\opp\) has support in \(\opq\). Then, we can brute-force using the definitions, starting from the cross-entropy:</p> \[\begin{aligned} \CrossEntropy{\pof{Y}}{\qof{Y}}&amp;=\CrossEntropy{\pof{Y}}{\E{\qof{x}}{\pof{Y \given x}}}\\ &amp;=\CrossEntropy{\pof{Y}}{\E{\qof{x}}{\frac{\pof{x \given Y}\pof{Y}}{\pof{x}}}}\\ &amp;=\CrossEntropy{\pof{Y}}{\E{\pof{x \given Y}}{\frac{\qof{x}}{\pof{x}}}}+\CrossEntropy{\pof{Y}}{\pof{Y}}\\ &amp;\overset{(1)}{=}\CrossEntropy{\pof{Y}}{\E{\pof{x \given Y}}{\frac{\qof{x}}{\pof{x}}}}+\xHof{\pof{Y}}\\ &amp;\overset{(2)}{\le}\CrossEntropy{\pof{X, Y}}{\frac{\qof{X}}{\pof{X}}}+\xHof{\pof{Y}}\\ &amp;\overset{(3)}{=}\CrossEntropy{\pof{X}}{\frac{\qof{X}}{\pof{X}}}+\xHof{\pof{Y}}\\ &amp;\overset{(4)}{=}\Kale{\pof{X}}{\qof{X}}+\xHof{\pof{Y}}\\ \iff \Kale{\pof{Y}}{\qof{Y}}&amp;\le\Kale{\pof{X}}{\qof{X}}, \end{aligned}\] <p>where we have used <strong>(1)</strong> that the cross-entropy of a distribution with itself is just the entropy, <strong>(2)</strong> that the cross-entropy is convex and we can apply Jensen’s inequality, <strong>(3)</strong> that the RHS side of the cross-entropy does not depend on \(Y\) and we can trivially marginalize it out, and <strong>(4)</strong> that the definition of the Kullback-Leibler divergence is equivalent an (unnormalized) cross-entropy over a fraction.</p> <p>This makes it difficult to extract the case for equality, however.</p> <h4 id="equality-case">Equality Case</h4> <p>We have only one inequality in above proof, and it stems from applying Jensen’s inequality. Remembering the equality case for Jensen’s inequality, we recall:</p> <aside class="l-body box-note"> <p>We have equality in Jensen’s inequality:</p> \[g(\E{\pof{x}}{f(x)}) \le \E{\pof{x}}{g(f(x))},\] <p>iff \(g\) is linear (commutes with addition)<d-footnote>Specifically, linear in the convex hull of the support of $\pof{x}$.</d-footnote> or \(f(x)\) is constant.</p> </aside> <p>For <strong>(2)</strong>, this is sadly slightly more complex than it might seem on first glance. Let’s unwrap the term:</p> \[\CrossEntropy{\pof{Y}}{\E{\pof{x \given Y}}{\frac{\qof{x}}{\pof{x}}}} = \E{\pof{y}}{-\log \E{\pof{x \given y}}{\frac{\qof{x}}{\pof{x}}}}.\] <p>We take an expectation over \(\pof{y}\), so we need to look at almost all \(\pof{x \given y} \not= 0\) for (almost all) \(\pof{y} \not= 0\) separately to consider equality. \(-\log x\) is strictly convex—and thus not linear—so we need \(f(x) = \frac{\qof{X}}{\pof{X}}\) to be constant for any fixed \(y\) with \(\pof{y} \not= 0\)—only then have we equality in Jensen’s inequality.</p> <p>In the following, I will limit myself to the discrete case to avoid having to deal with measure theory<d-footnote>I currently don't have a good 'toolbox' to express simple ideas cleanly in measure theory. I'm working on it.</d-footnote>. To obtain equality, for all \(y\) with \(\pof{y} \not= 0\) (i.e. we have support) and for all \(x_1, x_2\) with \(\pof{x_1 \given y}, \pof{x_2 \given y} \not= 0\), we need \(\frac{\qof{x_1}}{\pof{x_1}} = \frac{\qof{x_2}}{\pof{x_2}}\). Equivalently (for the reader, why is then \(\pof{x_1} \not= 0?\)):</p> \[\begin{aligned} \frac{\qof{x_1}}{\pof{x_1}} &amp;= \frac{\qof{x_2}}{\pof{x_2}} \\ \iff \qof{x_1} &amp;= \frac{\qof{x_2}}{\pof{x_2}} \, \pof{x_1} \\ \end{aligned}\] <p>This means that \(\qof{x} = C_y \pof{x}\) piecewise for all \(x\) for which \(\pof{x \given y} \not= 0\) for some fixed \(y\) with \(\pof{y} \not= 0\). That is if we keep \(y\) fixed, all the \(x\) for which \(\pof{x \given y} \not= 0\) have the same constant factor \(C_y\). Then for all \(y\) with \(\pof{y} \not= 0\), we have equality and overall equality in <strong>(2)</strong>.</p> <p>If for any \(x\) there are multiple \(y\), e.g. \(y_1, y_2\) for which \(\pof{x \given y} \not= 0\), then we have \(C_{y_1} = C_{y_2}\).</p> <p>As an example, at the simplest, if this is the case for all \(y\), then \(C_y = 1\) constant.</p> <p>As a side-note, this is a great reason why we often require full support for distributions as we then can avoid these piecewise constant factors (and the headaches they might cause).</p> <h4 id="simpler-elegant-proof">Simpler Elegant Proof</h4> <p>Thomas and Cover provide a beautifully simple proof:</p> <aside class="l-body box-note"> <p>Using the chain rule of the KL divergence:</p> \[\begin{aligned} \Kale{\pof{X, Y}}{\qof{X, Y}} &amp;= \Kale{\pof{X}}{\qof{X}} \\ &amp;+ \Kale{\pof{Y \given X}}{\qof{Y \given X}}, \end{aligned}\] <p>and its symmetry, we have:</p> \[\begin{aligned} &amp;\Kale{\pof{X}}{\qof{X}} + \underbrace{\Kale{\pof{Y\given X}}{\qof{Y \given X}}}_{=\Kale{\fof{Y\given X}}{\fof{Y \given X}}=0}\\ &amp;\quad =\Kale{\pof{X, Y}}{\qof{X, Y}}\\ &amp;\quad =\Kale{\pof{Y}}{\qof{Y}}+\underbrace{\Kale{\pof{X \given Y}}{\qof{X \given Y}}}_{\ge 0}\\ &amp;\quad \ge \Kale{\pof{Y}}{\qof{Y}}. \end{aligned}\] <p>We have equality exactly when \(\pof{x \given y} = \qof{x \given y}\) for (almost) all \(x, y.\)</p> </aside> <p>What does this mean? Whereas \(\fof{y \given x}\) is the ‘forward’ transition function, \(\pof{x \given y}\) and \(\qof{x \given y}\) are the ‘backward’ transition functions. We only have equality when the backward transition functions are equal (almost everywhere).</p> <p>The statement on equality is not very informative yet though, so we have to put in a bit more work. Again, this is written for the discrete case.</p> <p>This time we explicitly use Bayes’ rule to connect the forward and backward transition functions. First, we have to fix \(y\) such that \(\pof{y} \not= 0\) (i.e. \(y\) is in the support of \(\pof{y}\)) and then \(\qof{y} \not=0\). We have:</p> \[\begin{aligned} \pof{x \given y} &amp;= \qof{x \given y} \\ \overset{\text{ass. }\pof{y} \not= 0}{\iff} \frac{\fof{y \given x}\pof{x}}{\pof{y}} &amp;= \frac{\fof{y \given x}\qof{x}}{\qof{y}} \\ \overset{\text{ass. }\fof{y \given x}\not= 0}{\iff} \frac{\pof{x}}{\pof{y}} &amp;= \frac{\qof{x}}{\qof{y}} \\ \iff \pof{x} &amp;= \frac{\pof{y}}{\qof{y}} \, \qof{x}. \end{aligned}\] <p>For a given \(y\) with \(\pof{y} \not=0\), for the equality case, we see that for all \(x\) with \(\fof{y \given x} \not= 0\), \(\pof{x}\) and \(\qof{x}\) have to be coupled via piecewise constant factors.</p> <p>As another example, if \(\fof{y \given x} \not=0\) (has full support) for all possible \(x\), for the equality case we have \(\pof{x} = \qof{x}\).</p> <p>Compared to the previous equality case, we went a bit deeper and rewrote the conditions to consider the ratios between \(x\) and \(y\). Note we could have shown the same thing in the “brute-force” proof, too.</p> <p>Altogether, we have see that both \(x\) and \(y\) are modulated by the same constant factor between \(\pof{\cdot}\) and \(\qof{\cdot}\). Essentially, this tells us that we could split our support into unconnected sub-domains and examine each individually for the equality case.</p> <aside class="l-body box-note"> <p>One technicality is the question of what \(\pof{y \given x}\) is when \(\pof{x} = 0\). We could define it to be anything we want, but really it is undefined.</p> <p>Previously, we said that we want \(\pof{y \given x} = \fof{y \given x}\) and \(\qof{y \given x} = \fof{y \given x}\), but, given the above, we only need these equalities to hold where \(\pof{x} \not= 0\) and \(\qof{x} \not= 0\), respectively.</p> <p>On the other hand, \(\pof{x} = 0\) still implies \(\pof{x \given y} = 0\).</p> </aside> <h3 id="overall-statement">Overall Statement</h3> <p>We have the following overall statement:</p> <aside class="l-body box-warning"> <p>Given \(\pof{x}\) and \(\qof{x}\) and shared transition function \(\fof{y \given x}\) for the model \(X \rightarrow Y\), the relative KL data processing inequality is:</p> \[\Kale{\pof{X}}{\qof{X}} \ge \Kale{\pof{Y}}{\qof{Y}},\] <p>When \(\pof{x} \ll \qof{x}\), we have equality when \(\pof{X \given Y} = \qof{X \given Y}\).</p> </aside> <p>(\(\pof{x} \ll \qof{x}\) means that \(\qof{x} &gt; 0\) implies \(\pof{x} &gt; 0\), so the KL divergence is not \(\infty\).) But more precisely, for \(\pof{x} \ll \qof{x}\), we have equality when:</p> \[\forall y, \pof{y} \not= 0 \exists C_y \in \mathbb{R}_{&gt; 0} \forall x, \fof{y \given x}\not=0\colon \pof{x} = C_y \, \qof{x}.\] <h2 id="other-data-processing-inequalities">Other Data Processing Inequalities</h2> <p>Now, we can use these ideas to derive a few additional results and even close the circle to the original data processing inequality.</p> <h3 id="jensen-shannon-divergence">Jensen-Shannon Divergence</h3> <p>The KL divergence is not a metric: the triangle inequality does not hold, and it is not symmetric.</p> <p>However, we can symmetrize it to obtain the <a href="https://en.wikipedia.org/wiki/Jensen%E2%80%93Shannon_divergence" target="_blank" rel="noopener noreferrer">Jensen-Shannon divergence (JSD)</a>. The JSD is defined as the mean of the two KL divergences of the two distributions from their average. In essence, it makes the KL divergence symmetric:</p> \[\begin{aligned} \fof{x} &amp;= \frac{\pof{x} + \qof{x}}{2}\\ \JSD{\pof{x}}{\qof{x}} &amp;= \frac{1}{2} \Kale{\pof{x}}{\fof{x}} + \frac{1}{2} \Kale{\qof{x}}{\fof{x}}. \end{aligned}\] <p>Similar approaches can be used to “symmetrize” other concepts; for example matrices: \(\frac{1}{2} A + \frac{1}{2} A^T\) is also symmetric by construction for any matrix \(A\).</p> <p>The JSD is still not a metric, but the square root of the Jensen-Shannon divergence is symmetric and satisfies the triangle inequality and gives us the <em>Jensen-Shannon distance</em>, a metric.</p> <h3 id="jsd-dpi">JSD-DPI</h3> <p>We can also obtain a data processing inequality for the Jensen-Shannon divergence and the Jensen-Shannon distance:</p> <aside class="l-body box-warning"> <p>Given \(\pof{x}\) and \(\qof{x}\) and shared transition function \(\fof{y \given x}\) for the model \(X \rightarrow Y\), the Jensen-Shannon divergence data processing inequality is:</p> \[\JSD{\pof{X}}{\qof{X}} \ge \JSD{\pof{Y}}{\qof{Y}},\] <p>with equality exactly when \(\pof{x \given y} = \qof{x \given y}\) almost everywhere.</p> </aside> <p>The proof uses the KL data processing inequality:</p> \[\begin{aligned} \JSD{\pof{X}}{\qof{X}} &amp;= \frac{1}{2} \Kale{\pof{X}}{\fof{X}} + \frac{1}{2} \Kale{\qof{X}}{\fof{X}}\\ &amp;\ge \frac{1}{2} \Kale{\pof{Y}}{\fof{Y}} + \frac{1}{2} \Kale{\qof{Y}}{\fof{Y}}\\ &amp;= \JSD{\pof{Y}}{\qof{Y}}. \end{aligned}\] <p>We verify \(\fof{y} = \frac{\pof{y} + \qof{y}}{2}\) is the average of \(\pof{y}\) and \(\qof{y}\):</p> \[\begin{aligned} \fof{y} &amp;= \E{\fof{x}}{\fof{y \given x}}\\ &amp;= \E{\frac{\pof{x}+\qof{x}}{2}}{\fof{y \given x}}\\ &amp;= \frac{1}{2} \E{\pof{x}}{\fof{y \given x}} + \frac{1}{2} \E{\qof{x}}{\fof{y \given x}}\\ &amp;= \frac{1}{2} \pof{y} + \frac{1}{2} \qof{y}. \end{aligned}\] <p>Finally, \(\pof{x}, \qof{x} \ll \fof{x}\), and the equality condition of the KL data processing inequality gives us:</p> \[\begin{aligned} &amp;\Kale{\pof{X \given Y}}{\fof{X \given Y}} = 0 &amp;\\ \land \quad &amp;\Kale{\qof{X \given Y}}{\fof{X \given Y}} = 0 &amp;\\ \iff &amp;\pof{x \given y} = \fof{x \given y} \land \qof{x \given y} = \fof{x \given y}&amp; \forall x,y \\ \iff &amp;\pof{x \given y} = \qof{x \given y}&amp; \forall x,y. \end{aligned}\] <h3 id="mutual-information">Mutual Information</h3> <p>The JSD can also be expressed as a mutual information. For \(\begin{aligned} Z &amp;\sim \mathrm{Bernoulli}(\frac{1}{2}) = \fof{Z} \\ X \given Z = 0 &amp;\sim \pof{x}\\ X \given Z = 1 &amp;\sim \qof{x}, \end{aligned}\)</p> <p>we have:</p> \[\JSD{\pof{X}}{\qof{X}} = \MIof{X;Z}.\] <p>This follows from rewriting the mutual information as a KL divergence:</p> \[\begin{aligned} \MIof{X;Z} &amp;= \Kale{\fof{X \given Z}}{\fof{X}}\\ &amp;= \E{\fof{z}} {\Kale{\fof{X \given Z = z}}{\fof{X}}}\\ &amp;= \frac{1}{2} \Kale{\pof{x}}{\fof{x}} + \frac{1}{2} \Kale{\qof{x}}{\fof{x}}\\ &amp;= \JSD{\pof{X}}{\qof{X}}. \end{aligned}\] <p>We can generalize this to the Markov chain \(Z \rightarrow X \rightarrow Y\) with \(\fof{z, x, y} = \fof{z} \fof{x \given z} \fof{y \given x}\) for any distribution \(\fof{z}\):</p> \[\begin{aligned} \MIof{X;Z} &amp;= \Kale{\fof{X \given Z}}{\fof{X}}\\ &amp;= \E{\fof{z}} {\Kale{\fof{X \given z}}{\fof{X}}}\\ &amp;\overset{(1)}{\ge} \E{\fof{z}} {\Kale{\fof{Y \given z}}{\fof{Y}}}\\ &amp;= \Kale{\fof{Y \given Z}}{\fof{Y}}\\ &amp;= \MIof{Y;Z}, \end{aligned}\] <p>where \((1)\) follows from the KL data processing inequality.</p> <p>This is just the data processing inequality we presented initially. We have gone full circle!</p> <p>The equality gap (<em>Jensen gap</em>) is \(\Kale{\fof{X \given Y, Z}}{\fof{X \given Y}}\), and we have equality when:</p> \[\begin{aligned} \Kale{\fof{X \given Y, Z}}{\fof{X \given Y}} &amp;= 0\\ \iff \MIof{X;Z \given Y} &amp;= 0. \end{aligned}\] <p>This is exactly when \(X\) is independent of \(Z\) given \(Y\). (\(Y\) is a sufficient statistic in that case.)</p> <h2 id="function-space-variational-inference-1">Function-Space Variational Inference</h2> <p>So far we’ve explored the foundational aspects of the data processing inequality (DPI) and its extended forms, in particular the KL data processing inequality. Through detailed derivations and intuitive examples, we’ve demonstrated how these inequalities can be applied, emphasizing their significance and limitations. Specifically, we’ve shown how the KL data processing inequality relates to the reduction in information as data is processed. The examples and counterexample have hopefully demonstrated the nuances of applying these inequalities in different contexts.</p> <p>This exploration sets the stage for diving into function-space variational inference and building up a robust understanding of it, leveraging the insights gained about the DPI and its implications in Bayesian deep learning.</p> <h3 id="problem-setting--notation">Problem Setting &amp; Notation</h3> <p>In the following, we will consider a classification task with cross-entropy loss, and we will use the following the random variables and distributions:</p> <ul> <li>\(\y\) is the label,</li> <li>\(\x\) is the input,</li> <li>\(\qof{\y \given \x}\) is the predictive distribution we want to learn,</li> <li>\(\pdata{\y \given \x}\) is the data distribution,</li> <li>\(\Dany\) is the (training) dataset, and</li> <li>\(C\) is the number of classes.</li> </ul> <p>The probabilistic model is:</p> \[\pof{\y, \w \given \x} = \pof{\y \given \x, \w} \, \pof{\w}.\] <p>As before, I use upper-case letters for random variables, which we take an expectation over, e.g. in the KL divergence, and lower-case letters when I’m referring to specific observations or values that could be substituted (with the exception of \(\Dany\)).</p> <h3 id="chain-rule-of-the--divergence--dpi">Chain Rule of the 🥬 Divergence &amp; DPI</h3> <p>An important property of the KL divergence is the chain rule:</p> \[\begin{aligned} &amp;\Kale{\qof{\Y_n,...,\Y_1}}{\pof{\Y_n,...,\Y_1}} \\ &amp;\quad = \sum_{i=1}^n \Kale{\qof{\Y_i \given \Y_{i-1}, ..., \Y_1}}{\pof{\Y_i \given \Y_{i-1}, ..., \Y_1}}. \end{aligned}\] <p>The chain rule yields a <em>chain inequality</em> for the DPI as well:</p> \[\begin{aligned} \Kale{\qof{\W}}{\pof{\W}} &amp;\ge \Kale{\qof{\Y_n,...,\Y_1}}{\pof{\Y_n,...,\Y_1}}\\ &amp;\ge \Kale{\qof{\Y_{n-1},...,\Y_1}}{\pof{\Y_{n-1},...,\Y_1}}\\ &amp;\ge \Kale{\qof{\Y_1}}{\pof{\Y_1}}, \end{aligned}\] <p>where we start from the KL DPI and then apply the chain rule.</p> <h3 id="deriving-the-functional-elbo">Deriving the Functional ELBO</h3> <p>The DPI has an intriguing connection to FSVI. Let’s say we want to approximate a Bayesian posterior \(\pof{\w \given \Dany}\) with a variational distribution \(\qof{\w}\). In standard VI, we would minimize \(\Kale{\qof{\W}}{\pof{\W \given \Dany}}\) to match the variational distribution to the Bayesian posterior. Specifically:</p> \[\begin{aligned} &amp;\Kale{\qof{\W}}{\pof{\W \given \Dany}} =\\ &amp;\quad = \underbrace{\E{\qof{\w}}{-\log \pof{\Dany \given \w}} + \Kale{\qof{\W}}{\pof{\W}}}_{\text{Evidence}\ \text{Bound}} + \log \pof{\Dany} \ge 0 \\ &amp;\iff \underbrace{-\log \pof{\Dany}}_{=\xHof{\pof{\Dany}}} \le \E{\qof{\w}}{-\log \pof{\Dany \given \w}} + \Kale{\qof{\W}}{\pof{\W}}. \end{aligned}\] <p>This is an information-theoretic evidence (upper) bound on the information content \(-\log \pof{\Dany}\) of the data \(\Dany\) under the variational distribution \(\qof{\w}\), which we can minimize as an objective to approximiate \(\pof{\w \given \Dany}\) via \(\qof{\w}\).</p> <p>In more probability-theory inspired literature, the negative of this bound is called the <em>evidence lower bound (ELBO)</em> and is maximized.</p> <p>Both the ELBO and the information-theoretic evidence upper-bound are equivalent, and we can use either objective, but the information-theoretic perspective is obviously superior 🙃 I’ll refer to this as evidence bound from now on.</p> <p>In FSVI (with a caveat I detail below), we apply the DPI to the prior KL divergence term and obtain a “functional” version of the evidence bound:</p> \[\begin{aligned} \Kale{\qof{\W}}{\pof{\W}} \ge \Kale{\qof{\Y... \given \x...}}{\pof{\Y... \given \x...}}, \end{aligned}\] <p>where \(\Y... \given \x...\) are (finite or infinite) sets of samples. That is, we do not only optimize marginal distributions but also joint distributions.</p> <aside class="l-body box-note"> <p>For more on the specific differences between marginal and joint objectives, the workshop paper by Kirsch et al (2022)<d-cite key="kirsch2022marginal"></d-cite> provides conceptual thoughts on the differences between marginal and joint distributions. It builds on the following important papers:</p> <ul> <li>“The neural testbed: evaluating joint predictions” by Osband et al, 2022<d-cite key="osband2022neural"></d-cite> </li> <li>“Evaluating high-order predictive distributions in deep learning” by Osband et al, 2022<d-cite key="osband2022evaluating"></d-cite> </li> <li>“Beyond marginal uncertainty: how accurately can Bayesian regression models estimate posterior predictive correlations?” by Wang et al, 2021 <d-cite key="wang2021beyond"></d-cite> </li> </ul> </aside> <p>The resulting objective:</p> \[\begin{aligned} \E{\qof{\w}}{-\log \pof{\Dany \given \w}} + \Kale{\qof{\Y... \given \x...}}{\pof{\Y... \given \x...}} \end{aligned}\] <p>is equal to the (negative) <em>functional ELBO (fELBO)</em> in “<em>Functional variational Bayesian neural networks</em>” by Sun et al. (2019)<d-cite key="sun2019functional"></d-cite>—with caveats that we discuss below.</p> <h3 id="choosing-the-coreset-x">Choosing the “Coreset” \(\x...\)</h3> <p>One important detail is the question of how to choose the \(\x...\):</p> <p>Ideally, we want to choose them such that the DPI inequality is as tight as possible.</p> <p>Given the chain inequality, it is obvious that the larger the set \(\x...\), the tighter the inequality will be. Hence, if we could choose an infinite set of points well, we might be able to get the tightest possible inequality. However, this might not be tractable, and in practice, it is often not.</p> <p>Some works take a supremum over finite subsets of a certain size, essentially building a core-set as an approximation (Rudner et al., 2022a<d-cite key="rudner2022tractable"></d-cite>/b<d-cite key="rudner2022continual"></d-cite>); others take an expectation over finite sets of input samples (Sun et al., 2019)<d-cite key="sun2019functional"></d-cite>, which is not necessarily yielding the tightest inequality but provides an unbiased estimate; while again other works focus on finite datasets for which the all points can be taken into account (Klarner et al., 2023)<d-cite key="klarner2023drug"></d-cite>.</p> <p>We will discuss the tightness of the inequality and the implications in the data limit below.</p> <p>Focusing on the most important aspect of FSVI, we observe:</p> <aside class="l-body box-important"> <p>Instead of a parameter prior (term) \(\Kale{\qof{\W}}{\pof{\W}}\), we have a functional or <em>predictive</em> prior (term):</p> \[\Kale{\qof{\Y... \given \x...}}{\pof{\Y... \given \x...}}.\] </aside> <h3 id="application-to-continual-learning">Application to Continual Learning</h3> <p>When we directly optimize the KL divergence on a finite input dataset, for example, we align \(\opq\) with the prior of \(\opp\) where it matters most: on the predictions of the observed data.</p> <p>This is of particular interest in continual learning, where the prior for the next task is chosen to be the posterior from the previous task. In this case, the functional ELBO can be used to approximate the posterior of the previous model while incorporating new data.</p> <p>For two great papers that are very readable and provide further insights, see “<em>Continual Learning via Sequential Function-Space Variational Inference</em>“<d-cite key="rudner2022continual"></d-cite> and “<em>Tractable Function-Space Variational Inference in Bayesian Neural Networks</em>“<d-cite key="rudner2022tractable"></d-cite>, both by Rudner et al. (2022).</p> <h2 id="comparison-to-fsvi-in-the-literature">Comparison to FSVI in the Literature</h2> <aside class="l-body box-error"> <p>An important detail is that in above FSVI papers, the DPI is applied to the <em>logits</em> not the <em>probabilities</em>. That is, we have a distribution over logits, which adds an extra layer of uncertainty. Unlike the class probabilities, which we can also obtain from a deterministic neural network, thanks to the semantic interpretation of the outputs as distribution \(\pof{\y \given \x, \w}\), a deterministic neural network only provides us with deterministic logits and not a distribution over them. Only a (more) Bayesian approach can provide this.</p> <p>In general, we have the following inequality chain that relates the KL divergence between the logits \(\L\), which is a vector unlike \(\Y\), and the KL divergence between the output probabilities for \(\Y\) to the KL divergence between the parameters \(\W\):</p> \[\begin{aligned} \Kale{\qof{\W}}{\pof{\W}} &amp;\ge \Kale{\qof{\L...\given \x...}}{\pof{\L...\given \x...}} \\ &amp;\ge \Kale{\qof{\Y...\given \x...}}{\pof{\Y...\given \x...}}. \end{aligned}\] <p>This follows that from applying the DPI twice, as the logits are functions of the weights and the weights are functions of the logits.</p> </aside> <p>In practice, Rudner et al. (2022) and its continual learning follow-up linearize the logits<d-footnote>The logits are the final activations of the neural network before applying the softmax function (in multi-class classification). They are not to be confused with the pre-logits, e.g. embeddings before the final linear layer.</d-footnote> (similar to a Laplace approximation) and use the DPI to show (in their notation):</p> \[\mathbb{D}_{\mathrm{KL}}\left(q_{f(\cdot ; \boldsymbol{\Theta})} \| p_{f(\cdot ; \boldsymbol{\Theta})}\right) \leq \mathbb{D}_{\mathrm{KL}}\left(q_{\Theta} \| p_{\Theta}\right)\] <p>which in my notation is equivalent to the first application of the DPI above:</p> \[\Kale{\qof{\L...\given \x...}}{\pof{\L...\given \x...}} \le \Kale{\qof{\W}}{\pof{\W}}.\] <p>They maximize the fELBO objective:</p> \[\begin{aligned} \mathcal{F}\left(q_{\boldsymbol{\Theta}}\right) &amp;=\mathbb{E}_{q_{f\left(\mathbf{x}_{\mathcal{D}} ; \boldsymbol{\Theta}\right)}}\left[\log p_{\mathbf{y} \mid f(\mathbf{X} ; \boldsymbol{\Theta})}\left(\mathbf{y}_{\mathcal{D}} \mid f\left(\mathbf{X}_{\mathcal{D}} ; \boldsymbol{\theta}\right)\right)\right]\\ &amp;\quad -\sup _{\mathbf{X} \in \mathcal{X}_{\mathbb{N}}} \mathbb{D}_{\mathrm{KL}}\left(q_{f(\mathbf{X} ; \boldsymbol{\Theta})} \| p_{f(\mathbf{X} ; \boldsymbol{\Theta})}\right), \end{aligned}\] <p>which is equivalent to minimizing the information-theoretic objective:</p> \[\E{\qof{\w}}{-\log \pof{\Dany \given \w}} + \Kale{\qof{\L... \given \x...}}{\pof{\L... \given \x...}},\] <p>if we choose the \(\x...\) to tighten the DPI inequality as much as possible (i.e. by “finding” the supremum).</p> <p>Using the inequality chain from above, we can sandwich their objective between a regular (negative) ELBO and the (negative) functional ELBO, we have derived above:</p> \[\begin{aligned} &amp;\E{\qof{\w}}{-\log \pof{\Dany \given \w}} + \Kale{\qof{\W}}{\pof{\W}} \\ &amp;\quad \E{\qof{\w}}{-\log \pof{\Dany \given \w}} + \Kale{\qof{\L... \given \x...}}{\pof{\L... \given \x...}} \\ &amp;\quad \ge \E{\qof{\w}}{-\log \pof{\Dany \given \w}} + \Kale{\qof{\Y... \given \x...}}{\pof{\Y... \given \x...}}. \end{aligned}\] <p><strong>Why are they using logits instead of probabilities?</strong> In practice, using the probabilities instead of logits when performing linearization is often cumbersome due to the non-linearity of the softmax functions, which requires Monte-Carlo sampling of the logits to obtain an approximation of the final probabilities. Furthermore, I speculate that sampling the logits can be more benign given that we often use ReLUs in the underlying neural networks. (Don’t quote me too strongly on this, though.)</p> <p>Conceptually, this explains the derivation of their ELBO objective and also relates them to the ‘purer’ and simpler functional evidence bound derived above, but this raises the question of how these inequalities are different and what the gap between them tells us. Let’s address this question next.</p> <h2 id="the-equality-case-and-equivalence-classes">The Equality Case and Equivalence Classes</h2> <p>When do we have equality? That is, when do we have:</p> \[\Kale{\qof{\W}}{\pof{\W}} = \Kale{\qof{\Y... \given \x...}}{\pof{\Y... \given \x...}}?\] <p>And what does it tell us?</p> <p>As we have seen in the first part of this post, we have equality in the DPI if and only:</p> <p>\(\Kale{\qof{\W \given \Y..., \x...}}{\pof{\W \given \Y..., \x...}}=0\).</p> <p>Given that we are trying to approximate the Bayesian posterior \(\pof{\w \given \Y..., \x...}\) using \(\qof{\w}\), this equality condition tells us that we would have to find the exact posterior for equality. Hence, it is unlikely that we will have equality in practice. From this, the next question immediately follows: what does this predictive prior term</p> \[\Kale{\qof{\Y... \given \x...}}{\pof{\Y... \given \x...}}\] <p>provides us with?</p> <p>Another way to think about the gap between the two KL divergences is that one is parameter-based and the other one is not. This points to a deeper truth about overparameterized models used in deep learning:</p> <aside class="l-body box-important"> <p>Deep neural networks have many parameter symmetries, and it is often possible to permute the weights of a neural network without changing the outputs—for example, in a convolutional neural network, we could swap channels.</p> </aside> <p>The functional KL divergences won’t be affected by this as they are parameter-free and do not take into account the parameters of the model but only the predictions. The regular parameter-based KL divergence, however, would be affected by this—depending on the prior \(\pof{\w}\), they might express differences between the parameter distributions that have no effect on the outputs.</p> <p>In other words, if the prior assigns different probability to otherwise equivalent parameters, this obviously changes the parameter posterior, while the outputs are invariant to these changes if the overall assigned probability to a given output remains the same.</p> <aside class="l-body box-important"> <p>A better name for the functional KL divergence and function-space variational inference might be <em>predictive</em> KL divergence and <em>predictive variational inference</em>.</p> <p>To me, functions are an abstract thing, and determining how to assign a prior or even a distribution to them sounds difficult and complex, adding an air of mystique for me, whereas predictions are something I can easily understand and relate to.</p> </aside> <p>For example, the paper “Deep Ensembles: A Loss Landscape Perspective” by Fort et al. (2020)<d-cite key="fort2020deep"></d-cite> examines the similarity of the predictions of models trained from different initializations and shows that the prediction space has a multi-modal loss landspace. In the language of FSVI, this is similar to analyzing the function-space distances between different models.</p> <h3 id="equivalence-classes">Equivalence Classes</h3> <p>Unless there are other considerations, it makes sense to use priors that assign the same density to parameters that are equivalent. Hence, for a given function \(\fof{\x ; \w}\), which determines the likelihood \(\pof{\y \given \x, \w} \triangleq \pof{y \given \fof{\x ; \w}}\), we can define an equivalence relation such that \(\w \sim \w'\) if and only if \(\fof{\x; \w} = \fof{\x; \w'}\) <em>for all</em> \(\x\). This equivalence relation partitions the parameter space into equivalence classes:</p> \[[\w] \triangleq \{\w' : \fof{x ; \w} = \fof{x ; \w} \quad \forall x \}.\] <p>A prior \(\pof{\w}\) induces a prior \(\hpof{[\w]}\) over the equivalence classes:</p> \[\hpof{[\w]} \triangleq \sum_{\w' \in [\w]} \pof{\w'}.\] <p>—or \(\int_{[\w]} \pof{\w'} \, d \w'\) for continuous \(\w\)—with the corresponding model:</p> \[\begin{aligned} \hpof{\y, [\w] \given \x} &amp;\triangleq \hpof{\y \given \x, [\w]} \, \hpof{[\w]} \\ &amp;= \pof{\y \given \x, \w} \, \hpof{[\w]}. \end{aligned}\] <aside class="l-body box-error"> <p>Crucially, the definition of the equivalence classes depends on which \(\x\) we consider as part of the input domain: <em>different domains for \(\x\) will induce different equivalence classes.</em></p> <p>For example, for function families on \(\mathbb{R} \to \mathbb{R}\), if we restrict the domain to \(\x \in (0, 1)\), the equivalence classes will be different from the domain \(\x \in \mathbb{R}\). For \(\x \in (0, 1)\), we do not differentiate between functions that behave differently outside this domain. For example, for any \(k \ge 1,\)</p> \[\fof{x} = \begin{cases} x^2 &amp; \text{if } |x| \leq k \\ 2|x| - 2k + k^2 &amp; \text{otherwise} \end{cases}\] <p>has the same predictions within the domain \(\x \in (0, 1)\) while being different outside of it for different \(k\).</p> </aside> <h3 id="consistency">Consistency</h3> <p>Importantly, the definition of the equivalence classes above is consistent with Bayesian inference:</p> <aside class="l-body box-note"> <p>\([\w]\) commutes with Bayesian inference:</p> \[\hpof{[\w] \given \Dany} = \sum_{\w' \in [\w]} \pof{\w' \given \Dany}.\] </aside> <p>This is easy to show with using Bayes’ rule:</p> \[\begin{aligned} \hpof{[\w] \given \Dany} &amp;= \hpof{\Dany \given [\w]} \, \hpof{[\w]} / \hpof{\Dany} \\ &amp;= \pof{\Dany \given \w} \sum_{\w' \in [\w]} \pof{\w'} / \hpof{\Dany} \\ &amp;= \sum_{\w' \in [\w]} \pof{\Dany \given \w'} \, \pof{\w'} / \hpof{\Dany} \\ &amp;= \sum_{\w' \in [\w]} \pof{\w' \given \Dany} \, \pof{\Dany} / \hpof{\Dany} \\ &amp;= \sum_{\w' \in [\w]} \pof{\w' \given \Dany}. \end{aligned}\] <p>The last step follows from \(\hpof{\Dany}=\pof{\Dany}\):</p> \[\begin{aligned} \hpof{\Dany} &amp;= \sum_{[\w]} \hpof{\Dany, [\w]} \\ &amp;= \sum_{[\w]} \sum_{\w' \in [\w]} \pof{\Dany, \w'} \\ &amp;= \sum_{\w'} \pof{\Dany, \w} \\ &amp;= \pof{\Dany}. \end{aligned}\] <p>This also tells us that, for any \(\x\) and \(\y\):</p> <p>\(\pof{\y... \given \x...} = \hpof{\y... \given \x...}\).</p> <p>Given this consistency, we don’t have to differentiate between \(\hat\opp\) and \(\opp\) and can use \(\opp\) interchangeably. The same holds for \(\opq\).</p> <aside class="l-body box-important"> <p>This commutative property is not unique to the equivalence class mapping but rather a general characteristic of applying functions to random variables. The mapping \([\cdot]\) transforms the random variable \(\W\) into a new random variable \([\W]\), and remarkably, this transformation commutes with Bayesian inference.</p> <p>The proof above holds for any function \(\fof{\cdot}\) applied to a random variable. We are free to either draw a parameter sample from the posterior and then apply the function to it, or alternatively, perform Bayesian inference directly on the transformed random variable.</p> <p>Consequently, we have:</p> \[[\W \given \Dany] = [\W] \given \Dany.\] </aside> <p>These simple results deserve careful appreciation to fully internalize them.</p> <h3 id="equality--symmetries">Equality &amp; Symmetries</h3> <p>We can view \([\w]\) as a projection from \(\w\) to its equivalence class \([\w]\). The DPI then gives us:</p> \[\Kale{\qof{\W}}{\pof{\W}} \ge \Kale{\qof{[\W]}}{\pof{[\W]}}.\] <p>And again: what does the gap between the two terms tell us?</p> <aside class="l-body box-error"> <p>Intuitively speaking, \(\Kale{\qof{[\W]}}{\pof{[\W]}}\) captures the meaningful divergence between approximate and true distribution of the predictions, while \(\Kale{\qof{\W}}{\pof{\W}}\) also includes divergence due to parameter symmetries that have no effect on the predictions, now or later.</p> <p>The gap between the two terms tells us how much redundancy is captured by the parameter-based KL divergence.</p> </aside> <p>Let’s look at a few examples to get a better understanding of this.</p> <h4 id="1-trivial-constant-case">1. Trivial Constant Case</h4> <p>Let \(\fof{\x ; \w} = 0\) independent of any \(f\). Then \([\w] = [\w']\) for any \(\w\), \(\w'\).</p> <p>For any approximate distribution \(\qof{\w}\), the induced \(\Kale{\qof{[\W]}}{\pof{[\W]}}=0\), while \(\Kale{\qof{\W}}{\pof{\W}}\) also includes superfluous divergence.</p> <h4 id="2-unused-parameter">2. Unused Parameter</h4> <p>Let \(\y \given (\w_1, \w_2) = \w_1\) deterministic but independent of \(\w_2\). Then \([(\w_1, \w_2)] = [(\w_1, {\w'}_2)]\) for any \({\w'}_2\) and \([(\w_1,*)]\not=[({\w'}_1, *)]\) for any \(\w_1 \not= \w'_1\).</p> <p>\(\Kale{\qof{[\W]}}{\pof{[\W]}}=\Kale{\qof{\W_1}}{\pof{\W_1}}\) captures the meaningful divergence between approximate and true distribution, while \(\Kale{\qof{\W}}{\pof{\W}}\) also includes any divergence across \(\w_2\) that has no effect on the predictions.</p> <h4 id="3-periodic-parameter-space">3. Periodic Parameter Space</h4> <p>Finally, let’s assume that the predictions are periodic in some way. That is, for example \(\y = \sin \w\). We then have \([\w] = [\w + 2\pi]\).</p> <p>Further, let \(\pof{\w} = \operatorname{U}(\w; [0,2\pi \, N))\) for some \(N\) that determines the number of periods. Then, if we introduce another random variable \(K\), that captures which period we are in, we can (again) use the chain rule to write:</p> \[\begin{aligned} &amp;\Kale{\qof{\W}}{\pof{\W}} \\ &amp;\quad= \Kale{\qof{\W \given \W \in [K\,2\pi, (K+1)\,2\pi]}}{\pof{\W \given \W \in [K\,2\pi, (K+1)\,2\pi]}} \\ &amp;\quad + \Kale{\qof{\W \in [K\,2\pi, (K+1)\,2\pi]}}{\pof{\W \in [K\,2\pi, (K+1)\,2\pi]}} \\ &amp;\quad= \Kale{\qof{[\W]}}{\pof{[\W]}} \\ &amp;\quad\quad + \Kale{\qof{\W \in [K\,2\pi, (K+1)\,2\pi]}}{\pof{\W \in [K\,2\pi, (K+1)\,2\pi]}}. \end{aligned}\] <p>This follows from the setup of this specific example. Finally, we have:</p> \[\Kale{\qof{\W \in [K\,2\pi, (K+1)\,2\pi]}}{\pof{\W \in [K\,2\pi, (K+1)\,2\pi]}} \le \log N.\] <p>So, if \(\opq\) only had support in a single period for example, the difference between \(\Kale{\qof{\W}}{\pof{\W}}\) and \(\Kale{\qof{[\W]}}{\pof{[\W]}}\) would be \(\log N\): the redundancy.</p> <h3 id="predictive-prior">Predictive Prior</h3> <p>How does the predictive prior term fit into this? The DPI again yields the answer:</p> <aside class="l-body box-important"> <p>As the predictions are independent of the parameters, we can map from equivalence classes \([\w]\) to predictions, and the DPI yields:</p> \[\begin{aligned} \Kale{\qof{\W}}{\pof{\W}} &amp;\ge \Kale{\qof{[\W]}}{\pof{[\W]}} \\ &amp;\ge \Kale{\qof{\Y...\given\x...}}{\pof{\Y...\given\x...}}. \end{aligned}\] </aside> <p>This tells us that the predictive prior term can at best measure the KL divergence between the equivalence classes of the parameters—and not between the parameters itself—but luckily, this is the more meaningful divergence anyway!</p> <p>For the equality cases, we observe that:</p> <ol> <li>we need a 1:1 mapping between parameters and equivalence classes for the first bound to be tight, and</li> <li>we need \(\Kale{\qof{[\W] \given \Y_n,\x_n,...,\Y_1,\x_1}}{\pof{[\W] \given \Y_n,\x_n,...,\Y_1,\x_1}} \to 0\) for \(n \to \infty\) for the second bound to be tight, following the deductions in the first part of this post.</li> </ol> <p>For <strong>2.</strong>: as we know from the chain rule that</p> \[\Kale{\qof{\Y_n,...\Y_1\given\x_n,...,\x_1}}{\pof{\Y_n,...\Y_1\given\x_n,...,\x_1}}\] <p>is monotonically increasing in \(n\), and it is bounded by \(\Kale{\qof{[\W]}}{\pof{[\W]}}\) from above, it <em>must</em> converge<d-footnote>It is a <i>bounded monotonically increasing sequence.</i></d-footnote>. So, when does it close the gap?</p> <p>To give intuition that it might do that, and without attempting to prove this formally, we can appeal to <a href="https://en.wikipedia.org/wiki/Bernstein%E2%80%93von_Mises_theorem" target="_blank" rel="noopener noreferrer"><em>Bernstein von Mises</em> theorem</a>, which states that the posterior distribution of the parameters converges to a Gaussian distribution with mean and variance given by the maximum likelihood estimate (MLE) as the number of data points tends to infinity <em>as long as the model parameters are identifiable, that is the true parameters we want to learn are unique, and that they have support</em>.</p> <p>For the evidence bound to be meaningful, we already know that we need support of the approximate distribution \(\opq\) in the prior \(\opp\)—otherwise, the LHS is \(\infty\). Moreover, realizing that we take an expectation over \(\qof{\Y_n ,..., \Y_1 \given \x_n ,..., \x_1}\), we can decompose the KL term for the gap as:</p> \[\begin{aligned} &amp;\Kale{\qof{[\W] \given \Y_n,\x_n,...,\Y_1,\x_1}}{\pof{[\W] \given \Y_n,\x_n,...,\Y_1,\x_1}} \\ &amp;\quad = \E{\qof{\y_n,...,\y_1\given\x_n,...,\x_1}}{\Kale{\qof{[\W]\given \y_n, \x_n, ..., \y_1, \x_1}}{\pof{[\W]\given \y_n, \x_n, ..., \y_1, \x_1}}} \\ &amp;\quad = \simpleE{\qof{[\w']}}{\E{\qof{\y_n,..,.\y_1\given\x_n,...,\x_1, [\w']}}{\Kale{\qof{[\W]\given \y_n, \x_n, ..., \y_1, \x_1}}{\pof{[\W]\given \y_n, \x_n, ..., \y_1, \x_1}}}}. \end{aligned}\] <p>That is, we sample a \([\w'] \sim \qof{[\w']}\) and then sample \(\y_n,...\y_1\given\x_n,...,\x_1\) from the corresponding \(\qof{\y_n,...\y_1\given\x_n,...,\x_1, [\w']}\) and marginalize over these. Crucially, \([\w']\) are the true parameters of the data-generating process for the inner KL divergence term. We thus take an expectation over KL terms fulfilling the conditions of the Bernstein von Mises theorem:</p> \[\begin{aligned} \Kale{\qof{[\W] \given \y_n,\x_1...\y_1, \x_1}}{\pof{[\W] \given \y_n,\x_1...\y_1, \x_1}} \to 0. \end{aligned}\] <p>In other words:</p> <ol> <li> <p>For a given \([w']\), in the space of equivalence classes as defined previously, the equivalence class of all MLE solutions in the data limit, \([MLE]\), will be unique by definition—the model is identifiable—and match \([\w']\)<d-footnote>This follows from the consistency of MLE estimators but also from Berstein von Mises with a flat/uninformative prior.</d-footnote>.</p> </li> <li> <p>As the MLE is prior-independent once there is support for it, both \(\opq\) and \(\opp\) will converge to the MLE \([\w']\) with sufficient data. Taking the expectation, this yields \(\Kale{\qof{[\W]\given \Y,..., \x...}}{\pof{[\W] \given \Y,..., \x...}} \to 0\) for \(n \to \infty\), and thus, we have:</p> </li> </ol> \[\begin{aligned} &amp; \Kale{\qof{[\W]}}{\pof{[\W]}} = \\ &amp;\quad = \sup_{n\in \mathbb{N}} \Kale{\qof{\Y_n,...,\Y_1\given\x_n,...,\x_1}}{\pof{\Y_n,...,\Y_1\given\x_n,...,\x_1}}. \end{aligned}\] <p>(Again, this is not a formal proof but an intuition for why the gap might close in the data limit.)</p> <p>In my opinion, this is a great result. We have shown both that the predictive prior term converges given our assumptions and that it converges to the symmetry-free parameter-based divergence in the data limit. This is a strong argument for the predictive prior term being meaningful and not just a technical trick.</p> <p>Let’s appreciate one more thing: the predictive prior can consist of infinitely many data points and still converge to a finite value.</p> <h3 id="the-fsvi-objective">The FSVI Objective</h3> <p>The true objective of FSVI is to perform variational inference in the space of equivalence classes, approximating the posterior \(\pof{[\w] \given \Dany}\) that captures the meaningful aspects of the model while being invariant to parameter symmetries. This perspective reveals FSVI as a powerful and principled framework for Bayesian inference in overparameterized models, providing both conceptual and practical advantages over standard variational inference in parameter space.</p> <aside class="l-body box-important"> <p>FSVI aims to approximate the posterior distribution over <em>equivalence classes</em> of parameters \(\pof{[\w] \given \Dany}\) rather than the posterior over raw parameters \(\pof{\w \given \Dany}\).</p> </aside> <p>This is because \(\pof{[\w] \given \Dany}\) captures the meaningful aspects of the posterior, as it is invariant to the symmetries and equivalences in the parameter space that leave the likelihood unchanged.</p> <p>To achieve this, FSVI employs an implicit variational distribution \(\qof{[\w]}\) and minimizes the following objective, which is regular variational inference on the equivalence classes \(\Kale{\qof{[\W]}}{\pof{[\W] \given \Dany}}\), decomposed using the insights discussed:</p> \[\begin{aligned} &amp;\Hof{\Dany} \le \Hof{\Dany} + \underbrace{\Kale{\qof{[\W]}}{\pof{[\W] \given \Dany}}}_{\ge 0} \\ &amp;\quad = \Hof{\Dany} + \E{\qof{[\w]}}{-\log \pof{\Dany \given [\w]}} + \Kale{\qof{[\W]}}{\pof{[\W]}} - \Hof{\Dany}\\ &amp;\quad = \E{\qof{\w}}{-\log \pof{\Dany \given \w}} + \Kale{\qof{[\W]}}{\pof{[\W]}} \\ &amp;\quad = \sup_n \E{\qof{\w}}{-\log \pof{\Dany \given \w}} + \Kale{\qof{\Y_n... \given \x_n...}}{\pof{\Y_n... \given \x_n...}} \\ &amp;\quad \ge \E{\qof{\w}}{-\log \pof{\Dany \given \w}} + \Kale{\qof{\Y_n... \given \x_n...}}{\pof{\Y_n... \given \x_n...}} \quad \forall n. \end{aligned}\] <p>This objective differs from the standard variational inference objective in a subtle but crucial way: it operates in the space of equivalence classes \([\w]\) rather than the raw parameter space \(\w\). The likelihood term \(\pof{\Dany \given [\w]}\) is well-defined because all parameters \(\w\) within an equivalence class \([\w]\) induce the same likelihood by construction, allowing us to replace it with the likelihood term \(\pof{\Dany \given \w}\).</p> <p>The key insight is that FSVI leverages the data processing inequality (DPI) to avoid explicitly constructing the equivalence classes for the prior distribution or specifying a model that operates on them directly. By matching the predictive distributions via the predictive KL term, FSVI implicitly matches the priors over equivalence classes in the limit of infinite data, as shown in the previous section.</p> <p>This has advantages as overparameterized models are often simpler to optimize. The empirical evidence for this is the success of deep learning models, which are overparameterized and trained with stochastic gradient descent.</p> <p>This highlights the elegance and conceptual clarity of FSVI:</p> <aside class="l-body box-important"> <p>FSVI is a principled approach to Bayesian inference that respects the inherent symmetries and equivalences in overparameterized models. It focuses on approximating the meaningful posterior \(\pof{[\w] \given \Dany}\) while avoiding the complexities of explicitly constructing and working with equivalence classes.</p> </aside> <h2 id="parameter-priors-vs-predictive-priors">Parameter Priors vs. Predictive Priors</h2> <p>In Bayesian deep learning, we often use parameter priors that are not meaningful and which also do not take parameter symmetries into account. For example, a unit Gaussian prior over the parameters of a neural network does not induce different predictions for different parameters necessarily. While this prior can be sensible from a parameter compression perspective (e.g. see Hinton and van Camp (1993)<d-cite key="hinton1993keeping"></d-cite>), this does not have to be the only consideration guiding us.</p> <p>With function priors and predictive priors, we can specify more meaningful priors because we can focus on the predictions and ignore the parameters. More importantly, this connects Bayesian approaches to data augmentation and other regularization techniques as we will see next.</p> <p>Given that priors over equivalence classes are difficult to express explicitly though, using the DPI to obtain a functional ELBO can be an easier way to express and approximate them.</p> <h3 id="label-entropy-regularization">Label Entropy Regularization</h3> <p>All this also helps us gain a new perspective on label entropy regularization. The functional evidence bound can be lower-bounded using the chain rule by:</p> \[\begin{aligned} \E{\qof{\w}}{-\log \pof{\Dany \given \w}} + \Kale{\qof{\Y... \given \x...}}{\pof{\Y... \given \x...}} \\ \ge \E{\qof{\w}}{-\log \pof{\Dany \given \w}} + \E{\pdata{\x}}{\Kale{\qof{\Y \given \x}}{\pof{\Y \given \x}}}, \end{aligned}\] <p>where we can expand the term under the second expectation to:</p> \[\Kale{\qof{\Y \given \x}}{\pof{\Y \given \x}}=\CrossEntropy{\qof{\Y \given \x}}{\pof{\Y \given \x}} - \xHof{\qof{\Y \given \x}}.\] <p><em>Assuming that our prior yields a uniform distribution over the labels</em>, we can drop the cross entropy term because it is constant and obtain:</p> \[\E{\qof{\w}}{-\log \pof{\Dany \given \w}} - \E{\pdata{\x}}{\xHof{\qof{\Y \given \x}}}.\] <p>This is the same as an MLE minimization objective with an additional entropy regularization term \(-\xHof{\qof{\Y \given \x}}\) for different \(\x\) that prevents the model from overfitting to the labels and collapsing to the one-hot encoding of the labels.</p> <p>Thus, in the simplest approximation, the DPI and functional variational inference give us a new perspective on label entropy regularization.</p> <h3 id="knowledge-distillation">Knowledge Distillation</h3> <p>Obviously, assuming non-uniform prior predictions, \(\E{\pdata{\x}}{\Kale{\qof{\Y \given \x}}{\pof{\Y \given \x}}}\) can be related to knowledge distillation in deep neural networks as introduced by Hinton et al. (2015)<d-cite key="hinton2015distilling"></d-cite>.</p> <p>The main technical difference is that knowledge distillation is using the reverse KL divergence instead of the forward KL divergence, while the conceptual difference is that we are not distilling the knowledge from a teacher model but from the prior that we downweigh while also training our model on the data itself. However, the connection between knowledge distillation and continual learning using informative priors is manifest.</p> <h2 id="conclusion">Conclusion</h2> <p>In this blog post, we took a deep dive into the data processing inequality (DPI) and its surprisingly far-reaching implications for modern Bayesian deep learning. By carefully examining the assumptions, equality conditions, and chain rule of the DPI, we arrived at an intuitive understanding of why function-space variational inference (FSVI) can be such a powerful tool. The DPI perspective shows how FSVI side-steps issues with high-dimensional parameter spaces by focusing on matching Bayesian predictive posteriors.</p> <p>Reasoning about parameter equivalence classes under the lens of the DPI, we saw how predictive KL divergences can capture meaningful differences between models while ignoring superficial discrepancies due to symmetries. This provides a fresh perspective on the advantages of predictive priors over standard parameter priors commonly used in Bayesian neural networks.</p> <p>A key insight that emerged is that FSVI’s true objective is to perform variational inference in the space of predictive equivalence classes, approximating the posterior \(\pof{[\w] \given \Dany}\) that captures the meaningful aspects of the model while being invariant to parameter symmetries. By employing an implicit variational distribution and leveraging the DPI, FSVI sidesteps the need to explicitly define equivalence classes, relying instead on the fact that matching predictive distributions is sufficient to match the posteriors over equivalence classes in the infinite data limit. This reveals FSVI as a principled and elegant approach to Bayesian inference in overparameterized models.</p> <p>While our treatment only scratched the surface of the full mathematical story, the intuitions we developed allowed us to re-derive key results from the literature and uncover deep connections between seemingly disparate methods like entropy regularization, continual learning, and knowledge distillation. The examples and proofs peppered throughout solidified the core concepts.</p> <p>More than a bag of technical tricks, the DPI reveals itself to be a powerful conceptual tool for reasoning about models, objectives, and algorithms. I hope this post inspires the reader to seek the fundamental principles underpinning machine learning innovations and to use those principles as a guide for future research. With a solid grasp of foundational tools like the DPI, we can all contribute to demystifying and unifying the rapidly evolving field of Bayesian deep learning.</p> <hr> <p><strong>Acknowledgements.</strong> Many thanks to <a href="https://fbickfordsmith.com/" target="_blank" rel="noopener noreferrer">Freddie Bickford Smith</a> for very helpful comments and feedback on this post and to <a href="https://timrudner.com/" target="_blank" rel="noopener noreferrer">Tim Rudner</a> for additional pointers to relevant literature and feedback on the FSVI section in particular 🤗 GPT-4 and Claude 3 Opus were used for editing.</p> </d-article> <d-appendix> <d-footnote-list></d-footnote-list> <d-citation-list></d-citation-list> </d-appendix> </div> <d-bibliography src="/2024/assets/bibliography/2024-05-07-dpi-fsvi.bib"></d-bibliography> <d-article id="bibtex-container" class="related highlight"> For attribution in academic contexts, please cite this work as <pre id="bibtex-academic-attribution">
        PLACEHOLDER FOR ACADEMIC ATTRIBUTION
  </pre> BibTeX citation <pre id="bibtex-box">
        PLACEHOLDER FOR BIBTEX
  </pre> </d-article> <script src="https://utteranc.es/client.js" repo="iclr-blogposts/2024" issue-term="pathname" theme="github-light" crossorigin="anonymous" async> </script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> </body> </html>